---
import Layout from '../layouts/Layout.astro';
import NavBar from '../components/NavBar.astro';
import axios from 'axios';
const table = await axios.get('http://localhost:3000/api/v1/Roles').then((res) => res.data);
---
<Layout title="Historial de citas">
	<div class="pagos-container">
		<!-- Panel lateral izquierdo -->
		<NavBar />

		<!-- Contenido principal -->
		<div class="flex-1 flex flex-col overflow-hidden">
			<header class="bg-white/80 shadow-sm border-b border-gray-200">
				<div class="flex items-center justify-between px-6 py-4">
					<div class="flex">
						<h1>Roles y permisos</h1>
						<div class="flex ml-5 space-x-4">
							<input 
								type="text" 
								placeholder="Buscar..." 
								class="auth-input px-4 py-2 w-64"
							>
						</div>
                        <div>
                            <button id="CambiarEstado" class="auth-button px-4 py-2 text-sm ml-4">
                                Cambiar a permisos
                            </button>
                        </div>
					</div>
				</div>
			</header>
            <main>
                <div id="TableContainer">
                    <table id="Table">
				        <thead>
						    <tr id="TableHeader">
								<th><input type="checkbox" /></th>
								<th>Nombre</th>
								<th>Acciones</th>
							</tr>
						</thead>
						<tbody>
                            {table.map((Roles) => (
							<tr>
								<td><input type="checkbox" /></td>
								<td>{Roles.Nombre}</td>
								<td>
									<button class="btn-action">Acciones</button>
								</td>
							</tr>
                            ))}
						</tbody>
					</table>
				<!-- PAGINACIÓN Y BOTONES -->
				<div class="historial-pagination">
					<div class="text-sm text-gray-600">1–10 de 99</div>
					<div class="flex items-center gap-3">
						<span class="text-sm text-gray-600">Filas por página:</span>
						<select class="historial-select">
							<option>10</option>
							<option>25</option>
							<option>50</option>
						</select>
						<div class="flex items-center gap-2">
							<button class="btn-action px-3 py-1 text-sm">⟨</button>
							<span class="text-sm text-gray-600">1/10</span>
							<button class="btn-action px-3 py-1 text-sm">⟩</button>
						</div>
					</div>
				</div>
                </div>	
			</main>
		</div>
	</div>
</Layout>
<script type="module">
	import axios from 'axios';
	
	async function CambiarAPermiso() {
		// fetch permisos and handle the response (extend as needed)
		try {
			const Table = await axios.get('http://localhost:3000/api/v1/Permisos');
		} catch (err) {
			console.error(err);
		}
	}
	const button = document.getElementById('CambiarEstado');
	// Guard against null button before adding the listener
	if (button) {
		button.addEventListener('click', CambiarAPermiso);
	}

</script>